/* ===============================================
   MOBILE UTILITIES
   Touch targets, preview, navigation, forms
   =============================================== */

/* ===== GLOBAL TOUCH TARGET ENFORCEMENT ===== */
@media (max-width: 768px) {
    button,
    a,
    [role="button"],
    input[type="submit"],
    input[type="button"],
    .btn,
    .clickable,
    [onclick],
    label[for] {
        min-height: 44px !important;
        min-width: 44px !important;
        padding: 10px 16px !important;
    }

    button:has(svg:only-child),
    .icon-btn,
    .btn-icon {
        min-width: 44px !important;
        min-height: 44px !important;
        padding: 10px !important;
        display: inline-flex !important;
        align-items: center !important;
        justify-content: center !important;
    }

    .btn + .btn,
    button + button,
    a + a {
        margin-left: 8px !important;
    }
}

/* ===== IMPROVED MOBILE PREVIEW ZOOM ===== */
@media (max-width: 768px) {
    .a4-frame,
    .resume-frame,
    .template-preview-frame {
        width: 100% !important;
        max-width: 100% !important;
        height: auto !important;
        transform: none !important;
        transform-origin: top center !important;
    }

    .a4-scroll-container,
    .preview-scroll-container {
        width: 100% !important;
        overflow-x: auto !important;
        overflow-y: auto !important;
        -webkit-overflow-scrolling: touch !important;
        padding: var(--space-2) !important;
        background: var(--bw-gray-100) !important;
        border-radius: var(--radius-lg) !important;
    }

    .a4-frame {
        touch-action: pan-x pan-y pinch-zoom !important;
        user-select: none !important;
        -webkit-user-select: none !important;
    }

    .mobile-zoom-controls {
        position: fixed !important;
        bottom: 80px !important;
        left: 50% !important;
        transform: translateX(-50%) !important;
        display: flex !important;
        gap: var(--space-2) !important;
        padding: var(--space-2) var(--space-3) !important;
        background: rgba(0, 0, 0, 0.85) !important;
        backdrop-filter: blur(10px) !important;
        -webkit-backdrop-filter: blur(10px) !important;
        border-radius: var(--radius-full) !important;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3) !important;
        z-index: 1000 !important;
    }

    .mobile-zoom-controls button {
        width: 40px !important;
        height: 40px !important;
        min-width: 40px !important;
        min-height: 40px !important;
        padding: 0 !important;
        background: transparent !important;
        border: none !important;
        color: white !important;
        border-radius: 50% !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
    }

    .mobile-zoom-controls button:active {
        background: rgba(255, 255, 255, 0.2) !important;
    }

    .mobile-zoom-controls .zoom-level {
        color: white !important;
        font-size: 12px !important;
        font-weight: 700 !important;
        min-width: 50px !important;
        text-align: center !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
    }
}

/* ===== MOBILE STICKY BOTTOM CTA ===== */
@media (max-width: 768px) {
    .sticky-bottom-cta,
    .mobile-cta-bar,
    .fixed-bottom-nav {
        position: fixed !important;
        bottom: 0 !important;
        left: 0 !important;
        right: 0 !important;
        padding: var(--space-3) var(--space-4) !important;
        padding-bottom: calc(var(--space-3) + env(safe-area-inset-bottom, 0px)) !important;
        background: white !important;
        border-top: 1px solid var(--bw-gray-200) !important;
        box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1) !important;
        z-index: 999 !important;
        display: flex !important;
        gap: var(--space-3) !important;
        align-items: center !important;
    }

    .sticky-bottom-cta .btn-primary,
    .mobile-cta-bar .btn-primary {
        flex: 1 !important;
        min-height: 52px !important;
        font-size: 16px !important;
        font-weight: 700 !important;
        background: var(--bw-black) !important;
        color: white !important;
        border-radius: var(--radius-lg) !important;
        border: none !important;
        text-transform: uppercase !important;
        letter-spacing: 0.5px !important;
    }

    .sticky-bottom-cta .btn-secondary,
    .mobile-cta-bar .btn-secondary {
        min-width: 52px !important;
        min-height: 52px !important;
        padding: 0 !important;
        background: var(--bw-gray-100) !important;
        border: 1px solid var(--bw-gray-300) !important;
        border-radius: var(--radius-lg) !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
    }

    main,
    .main-content,
    .page-content {
        padding-bottom: 100px !important;
    }
}

/* ===== MOBILE FORM IMPROVEMENTS ===== */
@media (max-width: 768px) {
    .form-group,
    .input-group,
    .field-wrapper {
        margin-bottom: var(--space-4) !important;
    }

    .form-group label,
    .input-group label,
    .field-label {
        display: block !important;
        margin-bottom: var(--space-2) !important;
        font-size: 13px !important;
        font-weight: 600 !important;
        color: var(--bw-gray-700) !important;
        text-transform: uppercase !important;
        letter-spacing: 0.5px !important;
    }

    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="url"],
    input[type="password"],
    input[type="number"],
    input[type="date"],
    input[type="search"],
    select,
    textarea {
        width: 100% !important;
        min-height: 52px !important;
        padding: 14px 16px !important;
        font-size: 16px !important;
        font-weight: 500 !important;
        background: white !important;
        border: 2px solid var(--bw-gray-200) !important;
        border-radius: var(--radius-lg) !important;
        color: var(--bw-black) !important;
        -webkit-appearance: none !important;
        appearance: none !important;
        transition: border-color 0.2s ease, box-shadow 0.2s ease !important;
    }

    input:focus,
    select:focus,
    textarea:focus {
        border-color: var(--bw-black) !important;
        outline: none !important;
        box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.08) !important;
    }

    input.error,
    input.invalid,
    .input-error {
        border-color: #ef4444 !important;
        background: #fef2f2 !important;
    }

    input.success,
    input.valid,
    .input-success {
        border-color: #10b981 !important;
        background: #f0fdf4 !important;
    }

    textarea {
        min-height: 120px !important;
        resize: vertical !important;
        line-height: 1.5 !important;
    }

    select {
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23666'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'/%3E%3C/svg%3E") !important;
        background-repeat: no-repeat !important;
        background-position: right 16px center !important;
        background-size: 20px !important;
        padding-right: 48px !important;
    }

    .input-with-icon {
        position: relative !important;
    }

    .input-with-icon input {
        padding-left: 48px !important;
    }

    .input-with-icon .icon {
        position: absolute !important;
        left: 16px !important;
        top: 50% !important;
        transform: translateY(-50%) !important;
        color: var(--bw-gray-400) !important;
        pointer-events: none !important;
    }

    .validation-message,
    .field-error,
    .field-hint {
        margin-top: var(--space-2) !important;
        font-size: 13px !important;
        line-height: 1.4 !important;
    }

    .validation-message.error,
    .field-error {
        color: #ef4444 !important;
    }

    .validation-message.success {
        color: #10b981 !important;
    }
}

/* ===== MOBILE NAVIGATION ===== */
@media (max-width: 768px) {
    header,
    .top-nav,
    .navbar {
        height: 56px !important;
        min-height: 56px !important;
        padding: 0 var(--space-4) !important;
        background: white !important;
        border-bottom: 1px solid var(--bw-gray-200) !important;
        display: flex !important;
        align-items: center !important;
        justify-content: space-between !important;
        position: sticky !important;
        top: 0 !important;
        z-index: 100 !important;
    }

    .back-btn,
    .nav-back {
        min-width: 44px !important;
        min-height: 44px !important;
        padding: 0 !important;
        margin-left: -8px !important;
        background: transparent !important;
        border: none !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        color: var(--bw-black) !important;
    }

    .page-title,
    .nav-title {
        font-size: 17px !important;
        font-weight: 700 !important;
        color: var(--bw-black) !important;
        text-align: center !important;
        flex: 1 !important;
    }

    .step-indicator,
    .progress-steps {
        display: flex !important;
        gap: var(--space-1) !important;
        align-items: center !important;
    }

    .step-indicator .step,
    .progress-steps .step {
        width: 8px !important;
        height: 8px !important;
        border-radius: 50% !important;
        background: var(--bw-gray-300) !important;
        transition: all 0.2s ease !important;
    }

    .step-indicator .step.active,
    .progress-steps .step.active {
        background: var(--bw-black) !important;
        width: 24px !important;
        border-radius: 4px !important;
    }

    .step-indicator .step.completed,
    .progress-steps .step.completed {
        background: var(--bw-black) !important;
    }
}
